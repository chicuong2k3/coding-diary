@code {
    private HashSet<string> _openGroups = new HashSet<string>(StringComparer.OrdinalIgnoreCase) { "Getting Started", "Theme Config" };

    private readonly string _fileSvg = "<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/><polyline points=\"14,2 14,8 20,8\"/></svg>";

    private void ToggleGroup(string key)
    {
        if (_openGroups.Contains(key)) _openGroups.Remove(key);
        else _openGroups.Add(key);
    }

    private bool IsGroupOpen(string key) => _openGroups.Contains(key);

    private Dictionary<string, object> GetAria(bool open) => new Dictionary<string, object>
    {
        ["aria-expanded"] = open.ToString().ToLowerInvariant()
    };

    // Static menu items matching the reference design
    private static readonly List<NavGroup> MenuGroups = new()
    {
        new NavGroup("Getting Started", new List<NavItem>
        {
            new NavItem("Installation", "/guide/installation"),
            new NavItem("Update", "/guide/update"),
            new NavItem("Theme Config", "/guide/theme-config"),
            new NavItem("Site Config", "/guide/site-config"),
            new NavItem("Frontmatter Config", "/guide/frontmatter"),
            // Added site-level links
            new NavItem("About", "/about"),
            new NavItem("Sitemap", "/sitemap"),
        }),
        new NavGroup("Theme Config", new List<NavItem>
        {
            new NavItem("Home", "/theme/home"),
            new NavItem("Post Page", "/theme/post"),
            new NavItem("Footer", "/theme/footer"),
            new NavItem("Links Page", "/theme/links"),
            new NavItem("Navigation", "/theme/nav"),
            new NavItem("Pagination", "/theme/pagination"),
            new NavItem("Sidebar", "/theme/sidebar"),
            new NavItem("404 Page", "/theme/404"),
            new NavItem("Other Configurations", "/theme/other"),
            new NavItem("Post List", "/theme/postlist"),
        })
    };

    private record NavItem(string Title, string Href);
    private record NavGroup(string Name, List<NavItem> Items);
}

<div class="sidebar-nav-container">
    @foreach (var group in MenuGroups)
    {
        var open = IsGroupOpen(group.Name);
        <div class="nav-group">
            <button class="group-toggle" @onclick="() => ToggleGroup(group.Name)" @attributes="GetAria(open)">
                @group.Name
                <svg class="chevron @(open ? "open" : "")" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6,9 12,15 18,9"/>
                </svg>
            </button>
            <ul class="group-list @(open ? "open" : "")">
                @foreach (var item in group.Items)
                {
                    <li>
                        <NavLink class="nav-link" href="@item.Href" Match="NavLinkMatch.All">
                            <span class="nav-icon" aria-hidden="true">@((MarkupString)_fileSvg)</span>
                            <span class="nav-title">@item.Title</span>
                        </NavLink>
                    </li>
                }
            </ul>
        </div>
    }
</div>
